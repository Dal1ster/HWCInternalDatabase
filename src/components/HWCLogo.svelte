<script lang="ts">
	import { onMount } from 'svelte';
    import branding from '../lib/client/stores/branding';

    let div: HTMLDivElement;
    let currentOverride = $branding.e;

    onMount(() => {
        // Svelte browser bug workaround, the SVG animation will snap to the end state if replaced normally
        branding.subscribe((v) => {
            setTimeout(() => {
                if(!v.e || !div || currentOverride === v.e) {
                    return;
                }

                const svg = div.querySelector('svg');
                svg?.setCurrentTime(0);

                currentOverride = v.e;
            }, 100)
        })
    })

</script>

<div bind:this={div}>
    { #if !$branding['e'] }
        <svg viewBox="0 0 147 147" xmlns="http://www.w3.org/2000/svg">
            <path 
            d="M 7.527 107.746 C 7.606 107.746 10.384 108.46 13.665 109.307 C 22.529 111.635 24.857 111.873 27.291 110.63 C 28.535 109.995 29.725 108.169 30.122 106.317 C 30.184 106.008 30.234 104.656 30.271 102.2 C 30.308 99.745 30.333 96.185 30.344 91.463 C 30.355 86.741 30.352 80.855 30.334 73.747 L 30.254 42.526 L 29.619 41.124 C 28.164 37.922 25.598 37.049 20.438 38.028 C 19.274 38.24 15.888 39.086 12.845 39.88 C 9.829 40.674 7.183 41.335 6.971 41.335 C 6.389 41.335 8.612 37.076 11.284 32.975 C 13.833 29.085 16.696 25.493 19.864 22.206 C 23.032 18.919 26.505 15.938 30.273 13.272 C 34.041 10.606 38.104 8.254 42.452 6.225 C 46.473 4.347 48.352 3.765 50.865 3.579 C 53.67 3.394 55.152 3.95 55.945 5.511 C 56.422 6.49 56.448 7.495 56.58 29.561 L 56.713 52.58 L 57.374 53.903 C 59.094 57.396 62.587 59.724 67.746 60.835 C 70.656 61.444 77.059 61.444 79.864 60.835 C 84.203 59.856 88.066 57.184 89.6 54.062 C 89.838 53.568 90.077 53.074 90.315 52.58 L 90.447 29.561 C 90.579 7.892 90.606 6.49 91.056 5.564 C 91.744 4.214 93.278 3.5 95.448 3.5 C 97.697 3.5 99.655 4.056 103.623 5.775 C 107.865 7.627 111.937 9.906 115.772 12.555 C 119.606 15.203 123.204 18.222 126.497 21.556 C 129.791 24.89 132.781 28.538 135.4 32.445 C 138.072 36.441 139.66 39.404 139.66 40.436 L 139.66 41.309 L 137.755 40.78 C 127.489 37.922 122.964 37.155 120.768 37.896 C 119.34 38.346 118.123 39.536 117.408 41.124 L 116.773 42.526 C 116.747 52.845 116.72 63.163 116.694 73.482 C 116.676 80.89 116.67 86.849 116.678 91.544 C 116.686 96.239 116.708 99.67 116.745 102.022 C 116.782 104.374 116.835 105.647 116.905 106.026 C 117.302 108.143 118.255 109.704 119.631 110.497 C 122.038 111.9 124.42 111.688 133.415 109.307 C 136.723 108.434 139.501 107.772 139.58 107.852 C 139.765 108.037 137.252 112.455 135.426 115.154 C 132.675 119.255 130.082 122.377 126.298 126.161 C 119.631 132.908 113.201 137.406 104.602 141.401 C 98.438 144.258 94.178 145.158 92.379 144.02 C 90.5 142.83 90.606 144.1 90.447 118.197 L 90.315 94.914 L 89.415 93.247 C 87.616 89.939 83.885 87.558 79.176 86.711 C 76.027 86.129 69.307 86.288 66.635 86.976 C 62.481 88.061 59.041 90.495 57.48 93.458 L 56.713 94.914 L 56.58 117.8 C 56.422 142.433 56.448 141.93 54.993 143.544 C 54.305 144.311 54.12 144.391 52.321 144.444 C 50.68 144.523 49.939 144.391 47.849 143.676 L 47.849 143.676 C 42.531 141.877 33.879 137.115 28.323 132.961 C 20.968 127.404 13.797 119.255 9.167 111.185 C 7.686 108.592 7.289 107.746 7.527 107.746"
            fill="currentColor">
            </path>
        </svg>
    {:else}
        {@html $branding['e']}
    {/if}
</div>